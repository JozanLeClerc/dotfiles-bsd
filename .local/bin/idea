#!/bin/sh -e

if [ -z "$1" ]; then
	thought=$(cat | xargs)
elif [ -f "$1" ]; then
	thought=$(cat "$1" | xargs)
else
	thought="$*"
fi

date=$(date '+%a, %d %b %Y %T')
html_fmt='\t\t\t\t<h3>'"${date}"'<\/h3>\
\t\t\t\t<p>\
\t\t\t\t\t'"${thought}"'\
\t\t\t\t<\/p>\
'
gmi_fmt='\
\
## '"${date}"'\
\
'"${thought}"

sed -i '' -e '/<!-- thoughts here -->$/{n;s/^/'"${html_fmt}"'/;}' \
	"$HOME"/dev/web/joe-www/thoughts.html
git -C "$HOME"/dev/web/joe-www add -u
git -C "$HOME"/dev/web/joe-www commit -m "Thought: ${date}"
git -C "$HOME"/dev/web/joe-www push

sed -i '' -e '15i '"${gmi_fmt}" \
	"$HOME"/dev/web/joe-gemini/thoughts.gmi
git -C "$HOME"/dev/web/joe-gemini add -u
git -C "$HOME"/dev/web/joe-gemini commit -m "Thought: ${date}"
git -C "$HOME"/dev/web/joe-gemini push

vps
